{
  "operator": "executiontarget",
  "operatorId": 1,
  "cardinality": 1,
  "producesRows": true,
  "output": [{"expression": "iuref", "iu": ["v", ["Integer"]]}, {"expression": "iuref", "iu": ["v2", ["BigNumeric", 38, 6]]}],
  "outputNames": ["o_year", "mkt_share"],
  "input": {
    "operator": "sort",
    "operatorId": 2,
    "sqlpos": [[1446, 1452]],
    "cardinality": 1,
    "criterion": [{"value": {"expression": "iuref", "iu": "v"}, "descending": false, "nullFirst": false}],
    "input": {
      "operator": "map",
      "operatorId": 3,
      "sqlpos": [[149, 155]],
      "cardinality": 1,
      "input": {
        "operator": "groupby",
        "operatorId": 4,
        "sqlpos": [[1405, 1428], [165, 260], [263, 274]],
        "cardinality": 1,
        "input": {
          "operator": "map",
          "operatorId": 5,
          "sqlpos": [[350, 390]],
          "cardinality": 1,
          "input": {
            "operator": "join",
            "operatorId": 6,
            "cardinality": 1,
            "method": "hash",
            "referencedByScanEarlyProbe": true,
            "left": {
              "operator": "join",
              "operatorId": 7,
              "cardinality": 1,
              "method": "hash",
              "referencedByScanEarlyProbe": true,
              "left": {
                "operator": "join",
                "operatorId": 8,
                "cardinality": 1,
                "method": "hash",
                "referencedByScanEarlyProbe": true,
                "left": {
                  "operator": "tablescan",
                  "operatorId": 9,
                  "sqlpos": [[785, 791]],
                  "cardinality": 1,
                  "relationId": 9,
                  "schema": {"type":"sessionschema"},
                  "values": [{"name": "r_regionkey", "type": ["Integer"], "iu": ["v3", ["Integer"]]}, {"name": "r_name", "type": ["Char", 25], "iu": ["v4", ["Char", 25]]}, {"name": "r_comment", "type": ["Varchar", 152], "iu": null}],
                  "debugName": {"classification": "nonsensitive", "value": "region"},
                  "restrictions": [{"attribute": 1, "mode": "=", "value": {"expression": "const", "value": {"type": ["Char", 25], "value": "AMERICA"}}}],
                  "selectivity": 0.2,
                  "analyze": {"pipeline": 5, "cpu-cycles": 57, "running": false, "tuple-count": 1}
                },
                "right": {
                  "operator": "join",
                  "operatorId": 10,
                  "cardinality": 1.18216,
                  "method": "hash",
                  "referencedByScanEarlyProbe": true,
                  "left": {
                    "operator": "join",
                    "operatorId": 11,
                    "cardinality": 1.18216,
                    "method": "hash",
                    "referencedByScanEarlyProbe": true,
                    "left": {
                      "operator": "join",
                      "operatorId": 12,
                      "cardinality": 1.18216,
                      "method": "hash",
                      "referencedByScanEarlyProbe": true,
                      "left": {
                        "operator": "join",
                        "operatorId": 13,
                        "cardinality": 3.21951,
                        "method": "hash",
                        "referencedByScanEarlyProbe": true,
                        "left": {
                          "operator": "tablescan",
                          "operatorId": 14,
                          "sqlpos": [[551, 555]],
                          "cardinality": 3,
                          "relationId": 2,
                          "schema": {"type":"sessionschema"},
                          "values": [{"name": "p_partkey", "type": ["Integer"], "iu": ["v5", ["Integer"]]}, {"name": "p_name", "type": ["Varchar", 55], "iu": null}, {"name": "p_mfgr", "type": ["Char", 25], "iu": null}, {"name": "p_brand", "type": ["Char", 10], "iu": null}, {"name": "p_type", "type": ["Varchar", 25], "iu": ["v6", ["Varchar", 25]]}, {"name": "p_size", "type": ["Integer"], "iu": null}, {"name": "p_container", "type": ["Char", 10], "iu": null}, {"name": "p_retailprice", "type": ["Numeric", 12, 2], "iu": null}, {"name": "p_comment", "type": ["Varchar", 23], "iu": null}],
                          "debugName": {"classification": "nonsensitive", "value": "part"},
                          "restrictions": [{"attribute": 4, "mode": "=", "value": {"expression": "const", "value": {"type": ["Varchar", 25], "value": "ECONOMY ANODIZED STEEL"}}}],
                          "selectivity": 0.00562852,
                          "analyze": {"pipeline": 9, "cpu-cycles": 134, "running": false, "tuple-count": 3}
                        },
                        "right": {
                          "operator": "tablescan",
                          "operatorId": 15,
                          "sqlpos": [[615, 623]],
                          "cardinality": 572,
                          "relationId": 7,
                          "schema": {"type":"sessionschema"},
                          "values": [{"name": "l_orderkey", "type": ["Integer"], "iu": ["v7", ["Integer"]]}, {"name": "l_partkey", "type": ["Integer"], "iu": ["v8", ["Integer"]]}, {"name": "l_suppkey", "type": ["Integer"], "iu": ["v9", ["Integer"]]}, {"name": "l_linenumber", "type": ["Integer"], "iu": null}, {"name": "l_quantity", "type": ["Numeric", 12, 2], "iu": null}, {"name": "l_extendedprice", "type": ["Numeric", 12, 2], "iu": ["v10", ["Numeric", 12, 2]]}, {"name": "l_discount", "type": ["Numeric", 12, 2], "iu": ["v11", ["Numeric", 12, 2]]}, {"name": "l_tax", "type": ["Numeric", 12, 2], "iu": null}, {"name": "l_returnflag", "type": ["Char1"], "iu": null}, {"name": "l_linestatus", "type": ["Char1"], "iu": null}, {"name": "l_shipdate", "type": ["Date"], "iu": null}, {"name": "l_commitdate", "type": ["Date"], "iu": null}, {"name": "l_receiptdate", "type": ["Date"], "iu": null}, {"name": "l_shipinstruct", "type": ["Char", 25], "iu": null}, {"name": "l_shipmode", "type": ["Char", 10], "iu": null}, {"name": "l_comment", "type": ["Varchar", 44], "iu": null}],
                          "debugName": {"classification": "nonsensitive", "value": "lineitem"},
                          "earlyProbes": [{"builder": 13, "attributes": [1], "type": "lookup"}],
                          "selectivity": 1,
                          "analyze": {"pipeline": 8, "cpu-cycles": 726, "running": false, "tuple-count": 10}
                        },
                        "condition": {"expression": "comparison", "mode": "=", "left": {"expression": "iuref", "iu": "v5"}, "right": {"expression": "iuref", "iu": "v8"}},
                        "analyze": {"pipeline": 8, "memory-bytes": 18432, "tuple-count": 3}
                      },
                      "right": {
                        "operator": "tablescan",
                        "operatorId": 16,
                        "sqlpos": [[649, 655]],
                        "cardinality": 47,
                        "relationId": 6,
                        "schema": {"type":"sessionschema"},
                        "values": [{"name": "o_orderkey", "type": ["Integer"], "iu": ["v12", ["Integer"]]}, {"name": "o_custkey", "type": ["Integer"], "iu": ["v13", ["Integer"]]}, {"name": "o_orderstatus", "type": ["Char1"], "iu": null}, {"name": "o_totalprice", "type": ["Numeric", 12, 2], "iu": null}, {"name": "o_orderdate", "type": ["Date"], "iu": ["v14", ["Date"]]}, {"name": "o_orderpriority", "type": ["Char", 15], "iu": null}, {"name": "o_clerk", "type": ["Char", 15], "iu": null}, {"name": "o_shippriority", "type": ["Integer"], "iu": null}, {"name": "o_comment", "type": ["Varchar", 79], "iu": null}],
                        "debugName": {"classification": "nonsensitive", "value": "orders"},
                        "restrictions": [{"attribute": 4, "mode": "[]", "value": {"expression": "const", "value": {"type": ["Date"], "value": 2449719}}, "value2": {"expression": "const", "value": {"type": ["Date"], "value": 2450449}}}],
                        "earlyProbes": [{"builder": 12, "attributes": [0], "type": "lookup"}],
                        "selectivity": 0.367188,
                        "analyze": {"pipeline": 7, "cpu-cycles": 208, "running": false, "tuple-count": 2}
                      },
                      "condition": {"expression": "comparison", "mode": "=", "left": {"expression": "iuref", "iu": "v7"}, "right": {"expression": "iuref", "iu": "v12"}},
                      "analyze": {"pipeline": 7, "memory-bytes": 18432, "tuple-count": 2}
                    },
                    "right": {
                      "operator": "tablescan",
                      "operatorId": 17,
                      "sqlpos": [[681, 689]],
                      "cardinality": 129,
                      "relationId": 5,
                      "schema": {"type":"sessionschema"},
                      "values": [{"name": "c_custkey", "type": ["Integer"], "iu": ["v15", ["Integer"]]}, {"name": "c_name", "type": ["Varchar", 25], "iu": null}, {"name": "c_address", "type": ["Varchar", 40], "iu": null}, {"name": "c_nationkey", "type": ["Integer"], "iu": ["v16", ["Integer"]]}, {"name": "c_phone", "type": ["Char", 15], "iu": null}, {"name": "c_acctbal", "type": ["Numeric", 12, 2], "iu": null}, {"name": "c_mktsegment", "type": ["Char", 10], "iu": null}, {"name": "c_comment", "type": ["Varchar", 117], "iu": null}],
                      "debugName": {"classification": "nonsensitive", "value": "customer"},
                      "earlyProbes": [{"builder": 11, "attributes": [0], "type": "lookup"}],
                      "selectivity": 1,
                      "analyze": {"pipeline": 6, "cpu-cycles": 184, "running": false, "tuple-count": 4}
                    },
                    "condition": {"expression": "comparison", "mode": "=", "left": {"expression": "iuref", "iu": "v13"}, "right": {"expression": "iuref", "iu": "v15"}},
                    "analyze": {"pipeline": 6, "memory-bytes": 18432, "tuple-count": 2}
                  },
                  "right": {
                    "operator": "tablescan",
                    "operatorId": 18,
                    "sqlpos": [[715, 721]],
                    "cardinality": 25,
                    "relationId": 8,
                    "schema": {"type":"sessionschema"},
                    "values": [{"name": "n_nationkey", "type": ["Integer"], "iu": ["v17", ["Integer"]]}, {"name": "n_name", "type": ["Char", 25], "iu": null}, {"name": "n_regionkey", "type": ["Integer"], "iu": ["v18", ["Integer"]]}, {"name": "n_comment", "type": ["Varchar", 152], "iu": null}],
                    "debugName": {"classification": "nonsensitive", "value": "n1"},
                    "earlyProbes": [{"builder": 10, "attributes": [0], "type": "lookup"}, {"builder": 8, "attributes": [2], "type": "lookup"}],
                    "selectivity": 1,
                    "analyze": {"pipeline": 4, "cpu-cycles": 144, "running": false, "tuple-count": 1}
                  },
                  "condition": {"expression": "comparison", "mode": "=", "left": {"expression": "iuref", "iu": "v16"}, "right": {"expression": "iuref", "iu": "v17"}},
                  "analyze": {"pipeline": 4, "memory-bytes": 18432, "tuple-count": 1}
                },
                "condition": {"expression": "comparison", "mode": "=", "left": {"expression": "iuref", "iu": "v18"}, "right": {"expression": "iuref", "iu": "v3"}},
                "analyze": {"pipeline": 4, "memory-bytes": 18432, "tuple-count": 1}
              },
              "right": {
                "operator": "tablescan",
                "operatorId": 19,
                "sqlpos": [[581, 589]],
                "cardinality": 518,
                "relationId": 3,
                "schema": {"type":"sessionschema"},
                "values": [{"name": "s_suppkey", "type": ["Integer"], "iu": ["v19", ["Integer"]]}, {"name": "s_name", "type": ["Char", 25], "iu": null}, {"name": "s_address", "type": ["Varchar", 40], "iu": null}, {"name": "s_nationkey", "type": ["Integer"], "iu": ["v20", ["Integer"]]}, {"name": "s_phone", "type": ["Char", 15], "iu": null}, {"name": "s_acctbal", "type": ["Numeric", 12, 2], "iu": null}, {"name": "s_comment", "type": ["Varchar", 101], "iu": null}],
                "debugName": {"classification": "nonsensitive", "value": "supplier"},
                "earlyProbes": [{"builder": 7, "attributes": [0], "type": "lookup"}],
                "selectivity": 1,
                "analyze": {"pipeline": 3, "cpu-cycles": 30, "running": false, "tuple-count": 1}
              },
              "condition": {"expression": "comparison", "mode": "=", "left": {"expression": "iuref", "iu": "v19"}, "right": {"expression": "iuref", "iu": "v9"}},
              "analyze": {"pipeline": 3, "memory-bytes": 18432, "tuple-count": 1}
            },
            "right": {
              "operator": "tablescan",
              "operatorId": 20,
              "sqlpos": [[750, 756]],
              "cardinality": 25,
              "relationId": 8,
              "schema": {"type":"sessionschema"},
              "values": [{"name": "n_nationkey", "type": ["Integer"], "iu": ["v21", ["Integer"]]}, {"name": "n_name", "type": ["Char", 25], "iu": ["v22", ["Char", 25]]}, {"name": "n_regionkey", "type": ["Integer"], "iu": null}, {"name": "n_comment", "type": ["Varchar", 152], "iu": null}],
              "debugName": {"classification": "nonsensitive", "value": "n2"},
              "earlyProbes": [{"builder": 6, "attributes": [0], "type": "lookup"}],
              "selectivity": 1,
              "analyze": {"pipeline": 2, "cpu-cycles": 36, "running": false, "tuple-count": 1}
            },
            "condition": {"expression": "comparison", "mode": "=", "left": {"expression": "iuref", "iu": "v20"}, "right": {"expression": "iuref", "iu": "v21"}},
            "analyze": {"pipeline": 2, "memory-bytes": 18432, "tuple-count": 1}
          },
          "values": [{"iu": ["v23", ["Integer"]], "value": {"expression": "extractyear", "input": {"expression": "iuref", "iu": "v14"}}}, {"iu": ["v24", ["BigNumeric", 25, 4]], "value": {"expression": "mul", "left": {"expression": "sub", "left": {"expression": "const", "value": {"type": ["Numeric", 1], "value": 1}}, "right": {"expression": "iuref", "iu": "v11"}}, "right": {"expression": "iuref", "iu": "v10"}}}],
          "analyze": {"pipeline": 2, "tuple-count": 1}
        },
        "keyExpressions": [{"expression": {"value": {"expression": "iuref", "iu": "v23"}}, "iu": ["v", ["Integer"]]}],
        "groupingSets": [{"keyIndices": [0], "coreIndices": [0], "behavior": "regular"}],
        "emptyGroups": false,
        "aggExpressions": [{"value": {"expression": "simplecase", "value": {"expression": "iuref", "iu": "v22"}, "cases": [{"cases": [{"expression": "const", "value": {"type": ["Varchar"], "value": "BRAZIL"}}], "value": {"expression": "iuref", "iu": "v24"}}], "else": {"expression": "const", "value": {"type": ["BigNumeric", 25, 4], "low": 0, "high": 0}}}}, {"value": {"expression": "iuref", "iu": "v24"}}],
        "aggregates": [{"source": 1, "operation": {"aggregate": "sum"}, "iu": ["v25", ["BigNumeric", 38, 4]]}, {"source": 0, "operation": {"aggregate": "sum"}, "iu": ["v26", ["BigNumeric", 38, 4]]}],
        "analyze": {"pipeline": 1, "cpu-cycles": 280, "memory-bytes": 18432, "running": false, "tuple-count": 1}
      },
      "values": [{"iu": ["v2", ["BigNumeric", 38, 6]], "value": {"expression": "div", "left": {"expression": "iuref", "iu": "v26"}, "right": {"expression": "iuref", "iu": "v25"}}}],
      "analyze": {"pipeline": 1, "tuple-count": 1}
    },
    "analyze": {"pipeline": 0, "cpu-cycles": 24, "memory-bytes": 262152, "running": false, "tuple-count": 1}
  },
  "analyze": {"error": null, "pipeline": 0}
}
